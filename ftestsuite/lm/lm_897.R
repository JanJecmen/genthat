
expected <- structure(list(coefficients = structure(c(54.875, 1.7125, 1.67916666666667, 
-1.82291666666667, -1.01375, 0.295, 2.80833333333333, -0.591666666666665, 
-1.99166666666667, -0.941666666666667, -1.175, 0.141666666666668, 
NA), .Names = c("(Intercept)", "block1", "block2", "block3", 
"block4", "block5", "N1", "P1", "K1", "N1:P1", "N1:K1", "P1:K1", 
"N1:P1:K1")), residuals = structure(c(-1.39166666666665, 4.475, 
-5.025, 1.94166666666666, -5.3, 2.8, 2.16666666666666, 0.333333333333335, 
3.80833333333333, -3.225, 1.075, -1.65833333333333, 4.225, 0.424999999999997, 
-0.508333333333332, -4.14166666666667, -2.825, 3.175, -1.75833333333333, 
1.40833333333333, -0.183333333333328, -1.65, -0.016666666666671, 
1.85), .Names = c("1", "2", "3", "4", "5", "6", "7", "8", "9", 
"10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", 
"21", "22", "23", "24")), effects = structure(c(-268.831499270454, 
4.84368145112785, 8.22620305284684, -12.6295371385231, -9.06725564876165, 
3.23156308928048, 13.7579673886322, 2.89856286229342, -9.75713414208632, 
4.61320568224166, -5.75630089554047, 0.694022093788572, 6.28914490349069, 
2.90676622558896, 1.79471834036782, -4.68979100446665, 0.170012995434782, 
2.52384168394127, -0.512859242211451, -1.99515257700059, 5.6352932925842, 
5.91816553023043, 1.15299995779506, 5.77199421873692), .Names = c("(Intercept)", 
"block1", "block2", "block3", "block4", "block5", "N1", "P1", 
"K1", "N1:P1", "N1:K1", "P1:K1", "", "", "", "", "", "", "", 
"", "", "", "", "")), rank = 12L, fitted.values = structure(c(50.8916666666667, 
58.325, 51.825, 55.0583333333333, 65.1, 55.7, 53.3333333333333, 
55.6666666666667, 58.9916666666667, 59.025, 68.425, 56.6583333333333, 
57.775, 48.375, 46.0083333333333, 48.3416666666667, 54.825, 48.325, 
51.5583333333333, 47.3916666666667, 57.3833333333333, 60.65, 
53.2166666666667, 54.15), .Names = c("1", "2", "3", "4", "5", 
"6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", 
"17", "18", "19", "20", "21", "22", "23", "24")), assign = c(0L, 
1L, 1L, 1L, 1L, 1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L), qr = structure(list(
    qr = structure(c(-4.89897948556636, 0.204124145231932, 0.204124145231932, 
    0.204124145231932, 0.204124145231932, 0.204124145231932, 
    0.204124145231932, 0.204124145231932, 0.204124145231932, 
    0.204124145231932, 0.204124145231932, 0.204124145231932, 
    0.204124145231932, 0.204124145231932, 0.204124145231932, 
    0.204124145231932, 0.204124145231932, 0.204124145231932, 
    0.204124145231932, 0.204124145231932, 0.204124145231932, 
    0.204124145231932, 0.204124145231932, 0.204124145231932, 
    0, 2.82842712474619, 0.293618720289987, 0.293618720289987, 
    -0.413488060896561, -0.413488060896561, -0.413488060896561, 
    -0.413488060896561, -0.0599346703032871, -0.0599346703032871, 
    -0.0599346703032871, -0.0599346703032871, -0.0599346703032871, 
    -0.0599346703032871, -0.0599346703032871, -0.0599346703032871, 
    -0.0599346703032871, -0.0599346703032871, -0.0599346703032871, 
    -0.0599346703032871, -0.0599346703032871, -0.0599346703032871, 
    -0.0599346703032871, -0.0599346703032871, 0, -1.11022302462516e-16, 
    4.89897948556635, 0.131043903848683, 0.223705936893245, 0.223705936893245, 
    0.223705936893245, 0.223705936893245, -0.434997515324831, 
    -0.434997515324831, -0.434997515324831, -0.434997515324831, 
    -0.0267492248609678, -0.0267492248609678, -0.0267492248609678, 
    -0.0267492248609678, -0.0267492248609678, -0.0267492248609678, 
    -0.0267492248609678, -0.0267492248609678, -0.0267492248609678, 
    -0.0267492248609678, -0.0267492248609678, -0.0267492248609678, 
    0, 1.11022302462516e-16, 1.11022302462516e-16, 6.92820323027551, 
    0.139856626635482, 0.139856626635482, 0.139856626635482, 
    0.139856626635482, 0.16106066551341, 0.16106066551341, 0.16106066551341, 
    0.16106066551341, -0.449735800108223, -0.449735800108223, 
    -0.449735800108223, -0.449735800108223, -0.016723098216004, 
    -0.016723098216004, -0.016723098216004, -0.016723098216004, 
    -0.016723098216004, -0.016723098216004, -0.016723098216004, 
    -0.016723098216004, 0, 2.22044604925031e-16, 0, 0, 8.94427190999916, 
    0.100129274681248, 0.100129274681248, 0.100129274681248, 
    0.115310143005018, 0.115310143005018, 0.115310143005018, 
    0.115310143005018, 0.125228713221935, 0.125228713221935, 
    0.125228713221935, 0.125228713221935, -0.459186368868474, 
    -0.459186368868474, -0.459186368868474, -0.459186368868474, 
    -0.0119727733685158, -0.0119727733685158, -0.0119727733685158, 
    -0.0119727733685158, 2.22044604925031e-16, 2.22044604925031e-16, 
    0, 0, 1.11022302462516e-16, 10.9544511501033, 0.0743141849867595, 
    0.0743141849867595, 0.0855811582117598, 0.0855811582117598, 
    0.0855811582117598, 0.0855811582117598, 0.0929425464196601, 
    0.0929425464196601, 0.0929425464196601, 0.0929425464196601, 
    0.115635425157402, 0.115635425157402, 0.115635425157402, 
    0.115635425157402, -0.465321446212342, -0.465321446212342, 
    -0.465321446212342, -0.465321446212342, 0, -6.66133814775094e-16, 
    2.22044604925031e-16, -4.44089209850063e-16, -1.11022302462516e-15, 
    0, 4.89897948556636, 0.127278261639249, 0.334679640765475, 
    -0.0735686496983882, -0.0735686496983882, 0.334679640765475, 
    -0.268067545936454, -0.268067545936454, 0.140180744527409, 
    0.140180744527409, -0.353865685204117, 0.0543826052597456, 
    -0.353865685204117, 0.0543826052597456, -0.382105691155853, 
    -0.382105691155853, 0.0261425993080103, 0.0261425993080103, 
    0, -2.22044604925031e-16, 0, -4.44089209850063e-16, -1.11022302462516e-16, 
    -2.22044604925031e-16, 3.33066907387547e-16, -4.89897948556636, 
    0.125110344931232, 0.0848436545218391, -0.323404635942024, 
    -0.283137945532631, -0.382197983654845, 0.0260503068090185, 
    -0.341931293245452, 0.0663169972184109, 0.056858690089666, 
    -0.311122909964805, -0.351389600374197, 0.0971253804990584, 
    -0.141743450764653, 0.26650483969921, 0.306771530108602, 
    -0.101476760355261, 0, 6.66133814775094e-16, -1.11022302462516e-16, 
    0, -4.44089209850063e-16, -2.22044604925031e-16, -2.22044604925031e-16, 
    0, 4.89897948556636, -0.100821628180647, 0.402188417872973, 
    0.0271587137651477, 0.188651629294304, -0.314358416759316, 
    -0.186378074813521, 0.127108460060586, 0.343343666965383, 
    0.471324008911178, 0.0298571320912764, -0.0316860371424416, 
    -0.216137242676864, 0.0973492921972434, -0.277680411910582, 
    0.225329634143038, 0, -6.66133814775094e-16, 0, -2.22044604925031e-16, 
    1.11022302462516e-16, 4.44089209850063e-16, -2.22044604925031e-16, 
    7.7715611723761e-16, -8.88178419700125e-16, -4.89897948556636, 
    -0.0403466092315192, 0.225461466438682, -0.224246889399894, 
    0.176395282014544, 0.0415611862703075, -0.288713548232644, 
    0.310616377654378, 0.175782281910142, -0.175605468770396, 
    -0.240072127603146, 0.0416526837736554, 0.52787453019843, 
    -0.0228139750590947, 0.393040434454194, 0, 2.22044604925031e-16, 
    0, 4.44089209850063e-16, -6.66133814775094e-16, 4.44089209850063e-16, 
    -8.88178419700125e-16, 4.44089209850063e-16, 2.22044604925031e-16, 
    4.44089209850063e-16, 4.89897948556636, 0.0277636811473061, 
    0.0719538614599866, -0.342211335284481, -0.0759114822314925, 
    -0.423612723673531, 0.583247663243577, 0.0330509353688393, 
    -0.0803116450306884, 0.240618350763521, -0.264075235082835, 
    0.399484073191431, 0.0568547607113739, -0.150712654683307, 
    0, 6.66133814775094e-16, 2.22044604925031e-16, 6.66133814775094e-16, 
    3.88578058618805e-16, 1.11022302462516e-16, -8.88178419700125e-16, 
    4.44089209850063e-16, 2.77555756156289e-17, 4.44089209850063e-16, 
    2.22044604925031e-16, 4.89897948556636, 0.0752758613592824, 
    -0.000363389229086798, 0.382056761752999, 0.168522643155866, 
    0.461001177018734, -0.0957688517093259, 0.367388908561689, 
    -0.233167291787034, 0.337080746964858, 0.430693015421903, 
    -0.263475453383865, -0.126077013306157, 0, 2.82842712474619, 
    1.63299316185545, 1.15470053837925, -2.68328157299975, -2.19089023002066, 
    -4.05267720118871e-16, 1.07686847576174e-16, 3.57667471714102e-16, 
    6.72050218427295e-16, -2.06695899137019e-16, -4.49510954955273e-17, 
    -1.26503730714006e-15, 0.136186746722599, 0.0168540339267945, 
    -0.00386900956300962, 0.294840891590314, 0.0661756034066517, 
    -0.15911005945013, -0.3777741987308, -0.456293778845696, 
    -0.0023428278052523, -0.674957918126366, -0.231008115988914
    ), .Dim = c(24L, 13L), .Dimnames = list(c("1", "2", "3", 
    "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", 
    "15", "16", "17", "18", "19", "20", "21", "22", "23", "24"
    ), c("(Intercept)", "block1", "block2", "block3", "block4", 
    "block5", "N1", "P1", "K1", "N1:P1", "N1:K1", "P1:K1", "N1:P1:K1"
    )), assign = c(0L, 1L, 1L, 1L, 1L, 1L, 2L, 3L, 4L, 5L, 6L, 
    7L, 8L), contrasts = structure(list(block = "contr.helmert", 
        N = "contr.helmert", P = "contr.helmert", K = "contr.helmert"), .Names = c("block", 
    "N", "P", "K"))), qraux = c(1.20412414523193, 1.29361872028999, 
    1.13104390384868, 1.08192611509531, 1.10012927468125, 1.07431418498676, 
    1.12727826163925, 1.30961544533023, 1.34064524863925, 1.36029556218292, 
    1.17562902483879, 1.15651254453237, 1.06835189747145), pivot = 1:13, 
    tol = 1e-07, rank = 12L), .Names = c("qr", "qraux", "pivot", 
"tol", "rank"), class = "qr"), df.residual = 12L, contrasts = structure(list(
    block = "contr.helmert", N = "contr.helmert", P = "contr.helmert", 
    K = "contr.helmert"), .Names = c("block", "N", "P", "K")), 
    xlevels = structure(list(block = c("1", "2", "3", "4", "5", 
    "6"), N = c("0", "1"), P = c("0", "1"), K = c("0", "1")), .Names = c("block", 
    "N", "P", "K")), call = quote(lm(formula = yield ~ block + 
        N * P * K, data = npk, singular.ok = TRUE)), terms = yield ~ 
        block + N * P * K, model = structure(list(yield = c(49.5, 
    62.8, 46.8, 57, 59.8, 58.5, 55.5, 56, 62.8, 55.8, 69.5, 55, 
    62, 48.8, 45.5, 44.2, 52, 51.5, 49.8, 48.8, 57.2, 59, 53.2, 
    56), block = structure(c(1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 
    3L, 3L, 3L, 3L, 4L, 4L, 4L, 4L, 5L, 5L, 5L, 5L, 6L, 6L, 6L, 
    6L), .Label = c("1", "2", "3", "4", "5", "6"), class = "factor"), 
        N = structure(c(1L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 
        2L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 2L, 2L, 1L, 1L
        ), .Label = c("0", "1"), class = "factor"), P = structure(c(2L, 
        2L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 
        2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L), .Label = c("0", 
        "1"), class = "factor"), K = structure(c(2L, 1L, 1L, 
        2L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 
        1L, 2L, 2L, 2L, 1L, 2L, 1L), .Label = c("0", "1"), class = "factor")), .Names = c("yield", 
    "block", "N", "P", "K"), terms = yield ~ block + N * P * 
        K, row.names = c(NA, 24L), class = "data.frame")), .Names = c("coefficients", 
"residuals", "effects", "rank", "fitted.values", "assign", "qr", 
"df.residual", "contrasts", "xlevels", "call", "terms", "model"
), class = "lm")
test(id=1096, code={
require(stats)
lm(data = npk, formula = yield ~ block + N * P * K, singular.ok = TRUE)}, o = expected)